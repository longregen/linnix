# Demo rules optimized for scenario detection
# Lower thresholds to trigger faster in demo environment

- name: memory_leak_demo
  detector: memory_growth
  threshold: 50  # MB growth
  duration: 10   # seconds
  severity: high
  cooldown: 30

- name: fork_storm_demo
  detector: forks_per_sec
  threshold: 10  # forks per second
  duration: 2    # seconds
  severity: high
  cooldown: 30

- name: fork_burst_demo
  detector: fork_burst
  threshold: 30  # total forks
  window_seconds: 5
  severity: medium
  cooldown: 30

- name: fd_leak_demo
  detector: fd_growth
  threshold: 100  # open FDs
  duration: 10    # seconds
  severity: high
  cooldown: 30

- name: cpu_spike_demo
  detector: cpu_percent
  threshold: 80
  duration: 5
  severity: medium
  cooldown: 30
